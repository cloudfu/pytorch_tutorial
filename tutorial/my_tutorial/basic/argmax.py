import torch

x = torch.randn(2,4,5)

print(x)
# > tensor([[[-0.2377, -1.0894,  1.7376, -1.7329,  0.4314],
#          [-1.4899, -0.7765, -0.8258, -0.5007,  0.3901],
#          [ 0.5550,  1.1423, -1.3531, -0.7470,  0.5840],
#          [-0.7997,  0.0681,  0.7373, -0.0090, -0.9902]],

#         [[-0.6789, -1.6443, -0.3977, -0.0783,  1.6161],
#          [-1.5234, -1.1999, -0.9181,  0.8778,  0.5733],
#          [ 1.1922, -0.4699, -0.2262,  0.9180,  0.0642],
#          [-0.6872,  0.3727,  1.3596, -0.8487, -0.8330]]])

# 着眼于 dim=对应标签号，之后记性扣减，
# dim=0 剩余 4,5 输出就是4,5
# dim=1 剩余 2,4 输出就是2,5
# dim=2 剩余 2,4 输出就是2,4

# 将dim=0合并，计算第二列和第三列进行softmax计算
# print(x.argmax(dim=0))
# > tensor([[0, 0, 0, 1, 1],
#         [0, 0, 0, 1, 1],
#         [1, 0, 1, 1, 0],
#         [1, 1, 1, 0, 1]])

print(x.argmax(dim=1))
# tensor([[3, 0, 0, 2, 0], 
#         [0, 2, 0, 0, 2]])

print(x.argmax(dim=2))
# > tensor([[2, 4, 1, 2],
#         [4, 3, 0, 2]])
